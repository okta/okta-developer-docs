(window.webpackJsonp=window.webpackJsonp||[]).push([[1488],{1147:function(t,a,s){"use strict";s.r(a);var n=s(8),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"okta-asp-net-core-mvc-quickstart"}},[t._v("Okta ASP.NET Core MVC Quickstart "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#okta-asp-net-core-mvc-quickstart","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("If you want a full, working example, head over to the "),s("a",{attrs:{href:"https://github.com/okta/samples-aspnetcore",target:"_blank",rel:"noopener noreferrer"}},[t._v("ASP.NET Core Samples"),s("OutboundLink")],1),t._v(" repository.")]),t._v(" "),s("h3",{attrs:{id:"create-a-new-project"}},[t._v("Create a new project "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#create-a-new-project","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("If you don't already have an ASP.NET Core project, create one using "),s("code",[t._v("dotnet new mvc")]),t._v(" or the ASP.NET Core Web Application template in Visual Studio. Choose "),s("strong",[t._v("No Authentication")]),t._v(" as the authentication type.")]),t._v(" "),s("p",[t._v("Install these packages in the new project:")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.nuget.org/packages/Microsoft.AspNetCore.All",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft.AspNetCore.All"),s("OutboundLink")],1),t._v(" (most projects will depend on this)")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.nuget.org/packages/Okta.AspNetCore",target:"_blank",rel:"noopener noreferrer"}},[t._v("Okta.AspNetCore"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"add-a-startup-class"}},[t._v("Add a Startup class "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#add-a-startup-class","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("Make sure you have these "),s("code",[t._v("using")]),t._v(" statements at the top of your "),s("code",[t._v("Startup.cs")]),t._v(" file:")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Authentication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cookies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Okta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Add the following code anywhere in your "),s("code",[t._v("ConfigureServices")]),t._v(" method, and add your Okta configuration:\n"),s("DomainAdminWarning")],1),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[t._v("services"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddAuthentication")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DefaultAuthenticateScheme "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CookieAuthenticationDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AuthenticationScheme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DefaultSignInScheme "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CookieAuthenticationDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AuthenticationScheme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DefaultChallengeScheme "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" OktaDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MvcAuthenticationScheme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddCookie")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddOktaMvc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("OktaMvcOptions")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    OktaDomain "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://${yourOktaDomain}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ClientId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{clientId}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ClientSecret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{clientSecret}"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ... the rest of ConfigureServices")]),t._v("\nservices"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("AddMvc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Then, in the "),s("code",[t._v("Configure")]),t._v(" method, add this line "),s("strong",[t._v("above")]),t._v(" the "),s("code",[t._v("UseMvc")]),t._v(" line:")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("UseAuthentication")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"additional-middleware-configuration"}},[t._v("Additional middleware configuration "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#additional-middleware-configuration","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("OktaMvcOptions")]),t._v(" class configures the Okta middleware. You can see all the available options in the project's "),s("code",[t._v("README")]),t._v(" "),s("a",{attrs:{href:"https://github.com/okta/okta-aspnet",target:"_blank",rel:"noopener noreferrer"}},[t._v("on GitHub"),s("OutboundLink")],1),t._v(". Once you have the middleware working, you can place the Okta configuration in "),s("code",[t._v("appsettings.json")]),t._v(" and reference it with the Configuration pattern:")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[t._v("OktaDomain "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Configuration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Okta:OktaDomain"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nClientId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Configuration"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Okta:ClientId"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("h3",{attrs:{id:"secure-your-application-s-routes"}},[t._v("Secure your application's routes "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#secure-your-application-s-routes","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("With this middleware in place, use the "),s("code",[t._v("[Authorize]")]),t._v(" attribute on controllers or actions to require a logged-in user:")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Authorize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IActionResult")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Protected")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Only for logged-in users!")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("View")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Alternatively, you can create actions to log the user in (or out):")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Authentication"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Cookies"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mvc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Okta"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AccountController")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Controller")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IActionResult")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Login")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("HttpContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("User"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Identity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsAuthenticated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Challenge")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OktaDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MvcAuthenticationScheme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("RedirectToAction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Index"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Home"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpPost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IActionResult")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Logout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SignOutResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            OktaDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MvcAuthenticationScheme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            CookieAuthenticationDefaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AuthenticationScheme\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"run-the-project"}},[t._v("Run the project "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#run-the-project","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("Start the project in Visual Studio, or with this command:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("dotnet run\n")])])]),s("p",[t._v("Open "),s("code",[t._v("http://localhost:8080")]),t._v(" in a private or incognito window in your browser. (Note that your port may be be a random number instead of 8080.)")]),t._v(" "),s("p",[t._v("Try navigating to a route that has the "),s("code",[t._v("[Authorize]")]),t._v(" attribute, or to the "),s("code",[t._v("/Account/Login")]),t._v(" action you created above. You'll be redirected to the Okta Sign-In page.")]),t._v(" "),s("h3",{attrs:{id:"that-s-it"}},[t._v("That's it! "),s("a",{staticClass:"header-anchor header-link",attrs:{href:"#that-s-it","aria-hidden":"true"}},[s("i",{staticClass:"fa fa-link"})])]),t._v(" "),s("p",[t._v("ASP.NET Core automatically populates "),s("code",[t._v("HttpContext.User")]),t._v(" with the information Okta sends back about the user. You can check whether the user is logged in with "),s("code",[t._v("User.Identity.IsAuthenticated")]),t._v(" in your actions or views, and see all of the user's claims in "),s("code",[t._v("User.Claims")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("a",{attrs:{href:"https://github.com/okta/samples-aspnetcore",target:"_blank",rel:"noopener noreferrer"}},[t._v("ASP.NET Core Samples repository"),s("OutboundLink")],1),t._v(" has more examples of authenticating and interacting with the user's information (claims).")]),t._v(" "),s("p",[t._v("If you want to do more with the user, you can use the "),s("a",{attrs:{href:"https://github.com/okta/okta-sdk-dotnet",target:"_blank",rel:"noopener noreferrer"}},[t._v("Okta .NET SDK"),s("OutboundLink")],1),t._v(" to get or update the user's details stored in Okta.")])])}),[],!1,null,null,null);a.default=e.exports}}]);