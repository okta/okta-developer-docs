<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Okta PHP Quickstart | Okta Developer</title>
    <meta name="description" content="Secure, scalable, and highly available authentication and user management for any app.">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.2.5/polyfill.min.js"></script>
  <script src="https://static.cloud.coveo.com/searchui/v2.7219/js/CoveoJsSearch.Lazy.min.js" defer="true"></script>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/manifest.json">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg">
  <meta name="msapplication-config" content="/favicon/browserconfig.xml">
  <link rel="stylesheet" href="https://developer.okta.com/sites/all/themes/developer/css/master.css">
  <link rel="stylesheet" href="https://coveo-oktaweb.pantheonsite.io/sites/all/modules/okta_coveo_search_developer/css/okta_coveo_search_developer.css?q49ktf">
  <meta http-equiv="XA-UA-Compatible" content="IE=edge">
  <script>
      // TypeKit
        (function(d) {
          var config = {
            kitId: 'jff5neq',
            scriptTimeout: 3000,
            async: true
          },
          h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/bwf-loadingb/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
        })(document);

      var isProduction = window.location.hostname === 'developer.okta.com';
      if (isProduction) {

        // START Google Tag Manager
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-KXMLV58');
        // END Google Tag Manager

      }
    </script>
    
    <link rel="preload" href="/assets/css/0.styles.15a2bd63.css" as="style"><link rel="preload" href="/assets/js/app.1df7935f.js" as="script"><link rel="preload" href="/assets/js/11.71506886.js" as="script"><link rel="preload" href="/assets/js/2.8712a879.js" as="script"><link rel="preload" href="/assets/js/4.57ec015f.js" as="script"><link rel="preload" href="/assets/js/10.75e07b2c.js" as="script"><link rel="preload" href="/assets/js/34.6da36575.js" as="script"><link rel="preload" href="/assets/js/1501.1ce5179a.js" as="script"><link rel="preload" href="/assets/js/41.aa8d1373.js" as="script"><link rel="preload" href="/assets/js/5.93479991.js" as="script"><link rel="preload" href="/assets/js/1.952b7ece.js" as="script"><link rel="preload" href="/assets/js/31.3153d314.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.15a2bd63.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="PageWrap Page"><div><header class="Header is-fixed"><div class="Wrap"><a href="https://developer.okta.com" class="Logo"><svg version="1.1" id="OktaLogo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 431.9 151.4" style="enable-background:new 0 0 431.9 151.4;" xml:space="preserve"><g><g><g><path d="M102.2,41.4c-21,0-38.1,17.1-38.1,38.1s17.1,38.1,38.1,38.1s38.1-17.1,38.1-38.1l0,0C140.3,58.5,123.2,41.4,102.2,41.4z M102.2,98.5c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19c0.1,10.5-8.4,19-18.9,19.1C102.3,98.6,102.2,98.6,102.2,98.5L102.2,98.5z"/><path d="M169.1,92.3c0-1.9,1.5-3.4,3.4-3.4c0.9,0,1.8,0.4,2.4,1c9.5,9.7,25.3,26.3,25.4,26.4c0.4,0.5,0.8,0.8,1.4,0.9l1.6,0.2h17.2c1.8,0,3.3-1.4,3.4-3.2c0-0.8-0.3-1.5-0.8-2.2l-28.6-29.2l-1.5-1.5c-3.2-3.9-2.9-5.4,0.8-9.3l22.6-25.1c1.1-1.4,0.8-3.5-0.6-4.6c-0.6-0.4-1.3-0.7-2-0.7h-17c-0.6,0.2-1.1,0.5-1.5,0.9L175,64.4c-1.3,1.4-3.4,1.5-4.8,0.2c-0.7-0.6-1.1-1.5-1.1-2.5V18.9c0-1.7-1.3-3-3-3c-0.1,0-0.2,0-0.3,0h-12.7c-2.2,0-3.3,1.5-3.3,2.8v95.8c0,2.2,1.8,2.8,3.3,2.8h12.7c1.7,0.1,3.2-1.2,3.3-2.9c0,0,0,0,0,0V92.3z"/><path d="M273,114l-1.4-12.8c-0.2-1.7-1.7-2.9-3.4-2.7c0,0,0,0-0.1,0l-2.9,0.2c-10.1,0-18.5-7.9-19-18c0-0.3,0-0.7,0-1V64.2c-0.1-2,1.5-3.6,3.5-3.7c0,0,0,0,0,0h17c1.7-0.1,3.1-1.5,3-3.2c0,0,0-0.1,0-0.1v-12c0-2.3-1.5-3.6-2.8-3.6h-17.1c-1.9,0.1-3.5-1.5-3.6-3.4c0,0,0,0,0,0V18.9c-0.1-1.7-1.5-3.1-3.2-3c0,0-0.1,0-0.1,0h-12.7c-1.6-0.1-3,1.1-3.1,2.7c0,0.1,0,0.1,0,0.2c0,0,0,61.7,0,62c0.5,21,17.9,37.6,38.9,37c1.4,0,2.9-0.2,4.3-0.3C272,117.2,273.2,115.7,273,114z"/></g><path d="M364.7,98c-10.8,0-12.4-3.8-12.4-18.3l0,0V44.8c0-1.8-1.4-3.2-3.2-3.2c0,0-0.1,0-0.1,0h-12.8c-1.8,0-3.2,1.4-3.3,3.2v1.6C314.6,36,291.3,42.5,281,60.8c-10.4,18.3-3.9,41.6,14.4,51.9c14,7.9,31.4,6.2,43.5-4.2c3.6,5.5,9.3,9.1,18.3,9.1c1.5,0,9.7,0.3,9.7-3.5v-13.6C367,99.2,366,98.1,364.7,98z M314.2,98.6c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19l0,0C333.2,90.1,324.7,98.6,314.2,98.6z"/></g><path d="M19.4,74c2.2-1.9,4.1-4.1,5.7-6.6c3.5-5.3,5.4-11.5,5.2-17.9V27c0-4.9,0.9-8.4,2.7-10.5c1.8-2.1,4.8-3,9.2-3h12.6c1.2,0,2.1-0.9,2.2-2.1l0,0V2.2C57,1,56,0,54.8,0c0,0,0,0,0,0H41.5c-7.8,0-12.9,2.1-18,7.6s-7.1,12.3-7.1,21.7v14.2c0,2.2-0.1,4-0.2,5.7v2.2c-0.5,3.2-1.8,6.2-3.6,8.9C9.4,64.7,5.1,70.9,0.9,74l0,0l-0.3,0.3l0,0l-0.2,0.3H0.2v0.3l0,0c-0.1,0.3-0.1,0.7,0,1l0,0v0.3h0.1l0.2,0.3l0,0l0.3,0.3l0,0c4.2,3.1,8.5,9.3,11.3,13.7c1.8,2.7,3.1,5.7,3.6,8.9v2.2c0.1,1.6,0.2,3.5,0.2,5.7v14.3c0,9.4,2.4,16.7,7.1,21.7s10.2,7.6,18,7.6h13.8c1.2,0,2.2-1,2.2-2.2V140l0,0c0-1.2-1-2.2-2.2-2.2H42.2c-4.4,0-7.5-1-9.2-3s-2.7-5.6-2.7-10.5v-22.4c0.2-6.4-1.7-12.6-5.2-17.9c-1.6-2.5-3.5-4.7-5.7-6.6l0,0c-0.9-0.7-1.1-2-0.4-2.9C19.2,74.3,19.3,74.2,19.4,74L19.4,74z"/><path d="M412.5,74c-2.2-1.9-4.1-4.1-5.7-6.6c-3.5-5.3-5.4-11.5-5.2-17.9V27c0-4.9-0.9-8.4-2.7-10.5s-4.8-3-9.2-3h-12.6c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0l0,0V2.2c0-1.2,1-2.2,2.2-2.2c0,0,0,0,0,0h13.4c7.8,0,12.9,2.1,18,7.6s7.1,12.3,7.1,21.7v14.2c0,2.2,0.1,4,0.2,5.7v2.2c0.5,3.2,1.8,6.2,3.6,8.9c2.8,4.5,7.1,10.7,11.3,13.7l0,0l0.3,0.3l0,0l0.2,0.3h0.1v0.3l0,0c0.1,0.3,0.1,0.7,0,1l0,0v0.3h-0.1l-0.2,0.3l0,0l-0.3,0.3l0,0c-4.2,3.1-8.5,9.3-11.3,13.7c-1.8,2.7-3.1,5.7-3.6,8.9v2.2c-0.1,1.6-0.2,3.5-0.2,5.7v14.3c0,9.4-2.4,16.7-7.1,21.7s-10.2,7.6-18,7.6h-13.4c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0V140l0,0c0-1.2,1-2.2,2.2-2.2l0,0h12.7c4.4,0,7.5-1,9.2-3s2.7-5.6,2.7-10.5v-22.4c-0.2-6.3,1.6-12.6,5.1-17.9c1.6-2.5,3.5-4.7,5.7-6.6l0,0c0.9-0.7,1.1-2,0.4-2.9C412.7,74.3,412.6,74.2,412.5,74L412.5,74z"/></g></svg></a> <nav class="Header-nav PrimaryNav"><ul class="menu"><li class="first expanded"><a href="/product/">Product</a> <ul class="menu"><li class="first"><a href="/product/">Overview</a> <!----></li><li><a href="/product/authentication/">Authentication</a> <!----></li><li><a href="/product/authorization/">Authorization</a> <!----></li><li><a href="/product/user-management/">User Management</a> <!----></li></ul></li><li><a href="/pricing/">Pricing</a> <!----></li><li><a href="/blog/">Blog</a> <!----></li><li class="expanded active"><a href="/docs/">Docs</a> <ul class="menu"><li class="first"><a href="/docs/">Get Started</a> <!----></li><li><a href="/docs/concepts/">Concepts</a> <!----></li><li><a href="/docs/guides/">Guides</a> <!----></li><li><a href="/docs/reference/">Reference</a> <!----></li></ul></li><li class="expanded"><a href="">Support</a> <ul class="menu"><li class="first"><a href="https://devforum.okta.com/">Okta Developer Forums</a> <!----></li><li><a href="mailto:developers@okta.com">developers@okta.com</a> <!----></li></ul></li></ul> <a href="#" class="PrimaryNav-toggle"><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round" class="MenuIcon"><path d="M1,16 L19,16" stroke="#FFFFFF" stroke-width="2" class="MenuIcon-line1"></path> <path d="M1,4 L19,4" stroke="#FFFFFF" stroke-width="2" class="MenuIcon-line2"></path> <path d="M1,10 L19,10" stroke="#FFFFFF" stroke-width="2" class="MenuIcon-line3"></path> <path d="M1,10 L19,10" stroke="#FFFFFF" stroke-width="2" class="MenuIcon-line4"></path></g></svg> <svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="CloseIcon"><g id="ALl-Boards" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Desktop" transform="translate(-915.000000, -235.000000)" fill="#FFFFFF"><g id="Search-bar-Active" transform="translate(30.000000, 26.000000)"><polygon id="Icon/Cross" points="901 210.6 899.4 209 893 215.4 886.6 209 885 210.6 891.4 217 885 223.4 886.6 225 893 218.6 899.4 225 901 223.4 894.6 217"></polygon></g></g></g></svg></a> <div class="PrimaryNav-cta"><a target="_blank" rel="noopener noreferrer" href="https://login.okta.com/" class="Button--redOutline">Login</a> <a href="https://developer.okta.com/signup/" class="Button--red">Sign up</a></div> <a data-search-toggle class="SearchIcon"></a></nav></div></header> <div data-search-bar class="SearchBar"><div class="Wrap"><div data-pipeline="developer-okta-com" class="SearchBox" style="display: flex;"><div class="CoveoOmnibox"></div> <div class="CoveoSearchButton">Search</div> <div class="CoveoAnalytics"></div></div></div></div></div> <!----> <section class="PageContent DynamicSidebar has-tableOfContents"><div class="Sidebar" data-v-705933f8><aside data-v-705933f8><h2 class="Sidebar-location Sidebar-toggle h6" data-v-705933f8>Navigation</h2> <div class="Sidebar-close Sidebar-toggle" data-v-705933f8></div> <div data-v-705933f8><div class="Sidebar-group" data-v-705933f8><h3 class="Sidebar-title" data-v-705933f8>Concepts</h3> <ul class="Sidebar-nav" data-v-705933f8><li data-v-705933f8><a href="/docs/concepts/api-access-management/" data-v-705933f8>API Access Management</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/authentication/" data-v-705933f8>Authentication</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/auth-servers/" data-v-705933f8>Authorization Servers</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/event-hooks/" data-v-705933f8>Event Hooks</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/events-api-migration/" data-v-705933f8>Events API Migration</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/identity-providers/" data-v-705933f8>External Identity Providers</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/feature-lifecycle-management/" data-v-705933f8>Feature Lifecycle Management</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/inline-hooks/" data-v-705933f8>Inline Hooks</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/key-rotation/" data-v-705933f8>Key Rotation</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/auth-overview/" data-v-705933f8>OAuth 2.0 &amp; OIDC</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/okta-hosted-flows/" data-v-705933f8>Okta-Hosted Flows</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/okta-organizations/" data-v-705933f8>Okta Organizations</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/saml/" data-v-705933f8>SAML</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/scim/" data-v-705933f8>SCIM</a> <!----></li><li data-v-705933f8><a href="/docs/concepts/social-login/" data-v-705933f8>Social Login</a> <!----></li></ul></div><div class="Sidebar-group" data-v-705933f8><h3 class="Sidebar-title" data-v-705933f8>Guides</h3> <ul class="Sidebar-nav" data-v-705933f8><li data-v-705933f8><a href="/docs/guides/customize-tokens-returned-from-okta/" data-v-705933f8>Customize tokens returned from Okta</a> <!----></li><li data-v-705933f8><a href="/docs/guides/protect-your-api/" data-v-705933f8>Protect your API endpoints</a> <!----></li><li data-v-705933f8><a href="/docs/guides/request-user-consent/" data-v-705933f8>Request user consent during authentication</a> <!----></li><li data-v-705933f8><a href="/docs/guides/sign-into-web-app/" data-v-705933f8>Sign users in to your web application</a> <!----></li><li data-v-705933f8><a href="/docs/guides/sign-into-spa/" data-v-705933f8>Sign users in to your SPA</a> <!----></li><li data-v-705933f8><a href="/docs/guides/sign-users-out/" data-v-705933f8>Sign users out</a> <!----></li><li data-v-705933f8><a href="/docs/guides/" data-v-705933f8>More...</a> <!----></li></ul></div><div class="Sidebar-group" data-v-705933f8><h3 class="Sidebar-title" data-v-705933f8>Reference</h3> <ul class="Sidebar-nav" data-v-705933f8><li data-v-705933f8><a href="/docs/reference/api-overview/" data-v-705933f8>API Overview</a> <!----></li><li data-v-705933f8><a href="/docs/reference/api/oidc/" data-v-705933f8>Sign in Your Users</a> <!----></li><li data-v-705933f8><a href="/docs/reference/api/roles/" data-v-705933f8>Manage Okta Resources</a> <!----></li><li data-v-705933f8><a href="/docs/reference/error-codes/" data-v-705933f8>Error Codes</a> <!----></li><li data-v-705933f8><a href="/docs/reference/import-hook/" data-v-705933f8>Import Hook</a> <!----></li><li data-v-705933f8><a href="/docs/reference/saml-hook/" data-v-705933f8>SAML Hook</a> <!----></li><li data-v-705933f8><a href="/docs/reference/registration-hook/" data-v-705933f8>Registration Hook</a> <!----></li><li data-v-705933f8><a href="/docs/reference/token-hook/" data-v-705933f8>Token Hook</a> <!----></li><li data-v-705933f8><a href="/docs/reference/okta-expression-language/" data-v-705933f8>Okta Expression Language</a> <!----></li><li data-v-705933f8><a href="/docs/reference/postman-collections/" data-v-705933f8>Postman Collections</a> <!----></li><li data-v-705933f8><a href="/docs/reference/rate-limits/" data-v-705933f8>Rate Limits</a> <!----></li><li data-v-705933f8><a href="/docs/reference/releases-at-okta/" data-v-705933f8>Release Life Cycle</a> <!----></li><li data-v-705933f8><a href="/docs/reference/scim/" data-v-705933f8>SCIM Protocol</a> <!----></li><li data-v-705933f8><a href="/docs/reference/webfinger/" data-v-705933f8>WebFinger</a> <!----></li></ul></div><div class="Sidebar-group" data-v-705933f8><h3 class="Sidebar-title" data-v-705933f8>Release Notes</h3> <ul class="Sidebar-nav" data-v-705933f8><li data-v-705933f8><a href="/docs/release-notes/" data-v-705933f8>Okta API Products Release Notes</a> <!----></li></ul></div></div></aside></div> <div class="PageContent-main"><a id="edit-link" href="https://github.com/okta/okta-developer-docs/edit/master/packages/@okta/vuepress-site/quickstart-fragments/php/generic-implicit//index.md" target="_blank" rel="noopener noreferrer" data-proofer-ignore="">Edit Page</a> <div class="content__default"><h2 id="okta-php-quickstart">Okta PHP Quickstart <a href="#okta-php-quickstart" aria-hidden="true" class="header-anchor header-link"><i class="fa fa-link"></i></a></h2> <p>Now that your clients can get tokens, let's validate those tokens on your server.</p> <p>When a request is made to the messages api of your PHP application, we need to get the bearer token from the
authorization header and validate that the token. If the token is valid, we can reply with the messages we want to
provide to the user, if not, we should return a 401 to let the front end know that the request could not be authorized.</p> <blockquote><p><strong>Note:</strong> The rest of this quickstart assumes that you have an understand of PHP and composer. You should have at least
PHP7 and the latest version of composer installed on your computer. Your project should contain a <code>composer.json</code>
file that is ready to have dependencies installed.</p> <p>If you would prefer to download a complete sample application instead, please visit <a href="https://github.com/okta/samples-php" target="_blank" rel="noopener noreferrer">PHP Sample Applications for Okta<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and follow those instructions.</p></blockquote> <h2 id="installing-dependencies">Installing Dependencies <a href="#installing-dependencies" aria-hidden="true" class="header-anchor header-link"><i class="fa fa-link"></i></a></h2> <p>There are a few libraries you will need to install in order for us to verify the token that is provided in the
Authorization header. We have created a JWT verifier library to help you decode and verify JWTs (which is how the
authroization token will be provided).</p> <div class="language-bash extra-class"><pre class="language-bash"><code>composer require okta/jwt-verifier
</code></pre></div><p>The JWT Verifier package that you have just installed is built as a wrapper around some of the popular PHP libraries.
The rest of this quickstart will assume that we are using the <a href="https://packagist.org/packages/spomky-labs/jose" target="_blank" rel="noopener noreferrer">spomky-labs/jose<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
The package is also built to allow you to use any PSR-7 compliant library for making http requests. The rest of this
quickstart will assume the use of the <a href="https://packagist.org/packages/guzzlehttp/psr7" target="_blank" rel="noopener noreferrer">guzzlehttp/psr7<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library.
Let's install these two packages with composer.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>composer require spomky-labs/jose guzzlehttp/psr7
</code></pre></div><h2 id="messages-api">Messages API <a href="#messages-api" aria-hidden="true" class="header-anchor header-link"><i class="fa fa-link"></i></a></h2> <p>Our client side application is going to be sending us a call to an api endpoint to get messages. In our example below,
we will not be using a router, so we need to change the endpoint of the fetch call in our client application code.
In your client side app, we need to change <code>/api/messages</code> to <code>/api/messages.php</code>. Once you are done, create the
file <code>/api/messages.php</code></p> <p>Our first step is to include the composer autoload file.  In your new <code>messages.php</code> file, add the following:</p> <blockquote><p><strong>Note:</strong> All code blocks will be added progressively to the file. The full file is provided at the end of this quickstart.</p></blockquote> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">require</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../vendor/autoload.php'</span><span class="token punctuation">;</span> <span class="token comment">// This path may be different for you.</span>
</code></pre></div><p>Next, we need to make sure that the authorization header is present, but we also need to ignore any <code>prefetch</code>
requests that have a request method of <code>OPTIONS</code>. We do this because the modern browsers will prefetch the page to
get all available options, but will not send the authorization header. If we return a <code>401 Unauthorized</code> during the
prefetch, the client side application will quit trying to make the call, and will no longer respond to the messages
api.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// Don't do anything for prefetch requests.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'OPTIONS'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Make sure the authorization header is available, if not return 401.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_AUTHORIZATION'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that we have ignored any requests for <code>OPTIONS</code> (prefetch requests) and made sure that the authorization header
is present, we can now begin our verification process.  First, we set up some variables to store some information in.
Next we extract the authentication type and the token from the Authorization header then we need to make sure that
the authentication type is a Bearer token.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$authType</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
<span class="token variable">$authData</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>

<span class="token comment">// Extract the auth type and the data from the Authorization header.</span>
<span class="token keyword">list</span><span class="token punctuation">(</span> <span class="token variable">$authType</span><span class="token punctuation">,</span> <span class="token variable">$authData</span> <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_AUTHORIZATION'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// If the Authorization Header is not a bearer type, return a 401.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$authType</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'Bearer'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Now we are ready to use our verifier library to make sure the token is valid. The library only requires a few options
to be set. Full documentation can be found in our <a href="https://github.com/okta/okta-jwt-verifier-php" target="_blank" rel="noopener noreferrer">github repository<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
All of this will be wrapped inside of a try catch block. If there are any exceptions, we will respond with a <code>401 Unauthorized</code> to tell the client there was an issue.</p> <div class="domain-admin-warning"><blockquote><p>
      Note: <code>https://{yourOktaDomain}</code> is different from your admin URL. <strong>Donâ€™t</strong> include <code>-admin</code> in the value.
      <br>
      When copying your Okta domain from the developer console, you can find the correct value in upper right corner of the dashboard.
    </p></blockquote></div> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Setup the JWT Verifier.</span>
    <span class="token variable">$jwtVerifier</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Okta<span class="token punctuation">\</span>JwtVerifier<span class="token punctuation">\</span>JwtVerifierBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setAdaptor</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Okta<span class="token punctuation">\</span>JwtVerifier<span class="token punctuation">\</span>Adaptors<span class="token punctuation">\</span>SpomkyLabsJose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setClientId</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'{clientId}'</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setIssuer</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'https://${yourOktaDomain}/oauth2/default'</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Verify the JWT from the Authorization Header.</span>
    <span class="token variable">$jwt</span> <span class="token operator">=</span> <span class="token variable">$jwtVerifier</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">verify</span><span class="token punctuation">(</span> <span class="token variable">$authData</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// We encountered an error, return a 401.</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, if we have made it to this point, everything checks out and you can respond with the messages you want to
supply the client application.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">//JWT is valid!</span>
<span class="token keyword">print</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'messages'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'message 1'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'message 2'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>All that is left is to start the php server and try it out. To start your PHP server, and to make sure everything
works with the proxy of the client code, you can run the following:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>php -S <span class="token number">0.0</span>.0.0:8000
</code></pre></div><blockquote><p><strong>Note:</strong> The port used above should match the port you specified in the proxy setup. The important part here is that
you use <code>0.0.0.0</code> for the host instead of <code>localhost</code> or <code>127.0.0.1</code>.  If you run into an issue where the browser
console is reporting <code>Proxy error: Could not proxy request /api/messages.php from localhost:3000 to http://localhost:8000.</code> or similar, close our of both servers (the client server and PHP) and make sure your proxy
port match and that you are using <code>0.0.0.0</code> when starting the PHP server.</p></blockquote> <h4 id="full-messages-api">Full Messages API <a href="#full-messages-api" aria-hidden="true" class="header-anchor header-link"><i class="fa fa-link"></i></a></h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// /api/messages.php</span>

<span class="token keyword">require</span> <span class="token constant">__DIR__</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/../vendor/autoload.php'</span><span class="token punctuation">;</span>

<span class="token comment">// Don't do anything for prefetch requests.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token single-quoted-string string">'OPTIONS'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Make sure the authorization header is available, if not return 401.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_AUTHORIZATION'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$authType</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
<span class="token variable">$authData</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>

<span class="token comment">// Extract the auth type and the data from the Authorization header.</span>
<span class="token keyword">list</span><span class="token punctuation">(</span> <span class="token variable">$authType</span><span class="token punctuation">,</span> <span class="token variable">$authData</span> <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token double-quoted-string string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'HTTP_AUTHORIZATION'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// If the Authorization Header is not a bearer token, return a 401.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$authType</span> <span class="token operator">!=</span> <span class="token single-quoted-string string">'Bearer'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Setup the JWT Verifier.</span>
    <span class="token variable">$jwtVerifier</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Okta<span class="token punctuation">\</span>JwtVerifier<span class="token punctuation">\</span>JwtVerifierBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setAdaptor</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>Okta<span class="token punctuation">\</span>JwtVerifier<span class="token punctuation">\</span>Adaptors<span class="token punctuation">\</span>SpomkyLabsJose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setClientId</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'{clientId}'</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setIssuer</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'https://${yourOktaDomain}/oauth2/default'</span> <span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Verify the JWT from the Authorization Header.</span>
    <span class="token variable">$jwt</span> <span class="token operator">=</span> <span class="token variable">$jwtVerifier</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">verify</span><span class="token punctuation">(</span> <span class="token variable">$authData</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// We encountered an error, return a 401.</span>
    <span class="token keyword">return</span> <span class="token function">http_response_code</span><span class="token punctuation">(</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//JWT is valid!</span>
<span class="token keyword">print</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'messages'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'message 1'</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'message 2'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div></div></div> <div class="TableOfContents TableOfContents" style="bottom:0px;top:100px;" data-v-4ef83c5f><div class="TableOfContents-item is-level1" data-v-4ef83c5f>
    
  </div> <!----> <div data-v-4ef83c5f><div class="TableOfContents-indicator" style="height:30px;transform:translate(0px, 0px);" data-v-4ef83c5f></div> <a href="#okta-php-quickstart" class="TableOfContents-item sidebar-link is-level2" style="display:undefined;" data-v-4ef83c5f>
      Okta PHP Quickstart
    </a><a href="#installing-dependencies" class="TableOfContents-item sidebar-link is-level2" style="display:undefined;" data-v-4ef83c5f>
      Installing Dependencies
    </a><a href="#messages-api" class="TableOfContents-item sidebar-link is-level2" style="display:undefined;" data-v-4ef83c5f>
      Messages API
    </a><a href="#full-messages-api" class="TableOfContents-item sidebar-link is-level4" style="display:undefined;" data-v-4ef83c5f>
      Full Messages API
    </a> <div class="TableOfContents-footer" data-v-4ef83c5f><a href="#" data-v-4ef83c5f>Top of Page</a></div></div></div></section> <footer class="Footer"><div class="Wrap"><div class="Row"><div class="Column--3 Column--medium-6 Column--xSmall-12"><a href="https://www.okta.com/" target="_blank" rel="noopener noreferrer"><div class="Logo"><img src="https://developer.okta.com/sites/all/themes/developer/images/logo-footer.png" alt="Okta"></div> <p>Visit okta.com</p></a></div> <div class="Column--3 Column--medium-12 Column--xSmall-12"><h4>Social</h4> <ul class="Footer-links"><li class="first"><a href="http://github.com/oktadeveloper" target="_blank" class="Footer-links--github">GitHub</a> <!----></li><li><a href="http://twitter.com/OktaDev" target="_blank" class="Footer-links--twitter">Twitter</a> <!----></li><li><a href="https://devforum.okta.com/" target="_blank" class="Footer-links--forum">Forum</a> <!----></li><li><a href="http://feeds.feedburner.com/OktaBlog" target="_blank" class="Footer-links--rss">RSS Blog</a> <!----></li><li><a href="https://www.youtube.com/channel/UC5AMiWqFVFxF1q9Ya1FuZ_Q/featured" target="_blank" class="Footer-links--youtube">YouTube</a> <!----></li></ul></div><div class="Column--3 Column--medium-12 Column--xSmall-12"><h4>More Info</h4> <ul class="Footer-links"><li class="first"><a href="https://developer.okta.com/integrate-with-okta/">Integrate With Okta</a> <!----></li><li><a href="https://developer.okta.com/blog/">Blog</a> <!----></li><li><a href="https://developer.okta.com/docs/release-notes/">Release Notes</a> <!----></li><li><a href="https://developer.okta.com/3rd_party_notices/">3rd Party Notices</a> <!----></li><li><a href="https://toolkit.okta.com/">Community Toolkit</a> <!----></li></ul></div><div class="Column--3 Column--medium-12 Column--xSmall-12"><h4>Contact & Legal</h4> <ul class="Footer-links"><li class="first"><a href="https://developer.okta.com/contact/">Contact Our Team</a> <!----></li><li><a href="https://developer.okta.com/contact-sales-enterprise/">Contact Sales</a> <!----></li><li><a href="mailto:developers@okta.com">Contact Support</a> <!----></li><li><a href="https://developer.okta.com/terms/">Terms &amp; Conditions</a> <!----></li><li><a href="https://developer.okta.com/privacy/">Privacy Policy</a> <!----></li></ul></div></div></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1df7935f.js" defer></script><script src="/assets/js/11.71506886.js" defer></script><script src="/assets/js/2.8712a879.js" defer></script><script src="/assets/js/4.57ec015f.js" defer></script><script src="/assets/js/10.75e07b2c.js" defer></script><script src="/assets/js/34.6da36575.js" defer></script><script src="/assets/js/1501.1ce5179a.js" defer></script><script src="/assets/js/41.aa8d1373.js" defer></script><script src="/assets/js/5.93479991.js" defer></script><script src="/assets/js/1.952b7ece.js" defer></script><script src="/assets/js/31.3153d314.js" defer></script>
  </body>
</html>
